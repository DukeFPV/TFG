/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.tsx&appDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.tsx&appDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_carlos_Desktop_TFG_TFG_src_app_api_chat_route_tsx__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chat/route.tsx */ \"(rsc)/./src/app/api/chat/route.tsx\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/carlos/Desktop/TFG/TFG/src/app/api/chat/route.tsx\",\n    nextConfigOutput,\n    userland: _Users_carlos_Desktop_TFG_TFG_src_app_api_chat_route_tsx__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS4wLjNfQG9wZW50ZWxlbWV0cnkrYXBpQDEuOS4wX3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGY2hhdCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2hhdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNoYXQlMkZyb3V0ZS50c3gmYXBwRGlyPSUyRlVzZXJzJTJGY2FybG9zJTJGRGVza3RvcCUyRlRGRyUyRlRGRyUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZjYXJsb3MlMkZEZXNrdG9wJTJGVEZHJTJGVEZHJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUNRO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvY2FybG9zL0Rlc2t0b3AvVEZHL1RGRy9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzeFwiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NoYXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvY2FybG9zL0Rlc2t0b3AvVEZHL1RGRy9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzeFwiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.tsx&appDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/chat/route.tsx":
/*!************************************!*\
  !*** ./src/app/api/chat/route.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/.pnpm/ai@3.4.33_openai@4.72.0_encoding@0.1.13_zod@3.23.8__react@18.3.1_sswr@2.1.0_svelte@5.2.2__sve_qsxmzikk3s2dtpwsa2wxtn3lvi/node_modules/ai/dist/index.mjs\");\n/* harmony import */ var _lib_utils_queries__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/utils/queries */ \"(rsc)/./src/lib/utils/queries.ts\");\n/* harmony import */ var _lib_db_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db/index */ \"(rsc)/./src/lib/db/index.ts\");\n/* harmony import */ var _lib_db_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db/schema */ \"(rsc)/./src/lib/db/schema.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var _ai_sdk_openai__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @ai-sdk/openai */ \"(rsc)/./node_modules/.pnpm/@ai-sdk+openai@1.0.1_zod@3.23.8/node_modules/@ai-sdk/openai/dist/index.mjs\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/context */ \"(rsc)/./src/lib/context.ts\");\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(rsc)/./node_modules/.pnpm/@clerk+nextjs@6.3.2_next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react_erh4rexutio6xfxki4qahuk4f4/node_modules/@clerk/nextjs/dist/esm/app-router/server/auth.js\");\n\n\n\n\n\n\n\n\n\n// Metodo alternativo para  manejar los logs\nfunction log(message) {\n    console.log(message);\n}\nasync function POST(req) {\n    //log('POST function called');  //Log para debug\n    try {\n        // Verificación de autenticación\n        const { userId } = await (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_5__.auth)();\n        if (!userId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_3__.NextResponse.json({\n                error: 'Unauthorized'\n            }, {\n                status: 401\n            });\n        }\n        const { messages, chatId } = await req.json();\n        const coreMessages = (0,ai__WEBPACK_IMPORTED_MODULE_6__.convertToCoreMessages)(messages);\n        log('chatId de chatId = ' + JSON.stringify(chatId)); //Log para debug\n        log('Log de messages = ' + JSON.stringify(messages)); //Log para debug\n        // Validate chatId\n        if (!chatId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_3__.NextResponse.json({\n                error: 'Chat ID is required'\n            }, {\n                status: 400\n            });\n        }\n        // Ensure chatId is a number\n        const chatIdValue = parseInt(chatId);\n        if (isNaN(chatIdValue)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_3__.NextResponse.json({\n                error: 'Invalid chat ID format'\n            }, {\n                status: 400\n            });\n        }\n        log('Type of chatId: ' + typeof chatIdValue); //Log para debug\n        log('Value of chatId: ' + chatIdValue); //Log para debug\n        const _chats = await _lib_db_index__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.chats).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.chats.id, chatIdValue));\n        log('Log de _chats = ' + JSON.stringify(_chats)); //Log para debug\n        if (_chats.length !== 1) {\n            return next_server__WEBPACK_IMPORTED_MODULE_3__.NextResponse.json({\n                error: 'Chat no encontrado'\n            }, {\n                status: 404\n            });\n        }\n        const fileKey = _chats[0].fileKey;\n        const lastMessage = messages[messages.length - 1];\n        const context = await (0,_lib_context__WEBPACK_IMPORTED_MODULE_4__.getContext)(lastMessage.content, fileKey);\n        log('Log de context = ' + JSON.stringify(context)); //Log para debug\n        // Definición de los mensajes iniciales que SARA utiliza para entender su contexto y cómo debe interactuar, se mantienen en ingles para facilitar la comprensión de la API de OpenAI\n        const prompt = [\n            {\n                // Mensaje de configuración del sistema que define el comportamiento de SARA\n                role: \"system\",\n                content: `You are an AI that is there to help the elderly in the use of ICT.\n      You must offer a personalized level of assistance and be able to respond in a clear way, always giving continuity to the answers so that the user has at all \n      times feedback of what is happening. You will be able to analyze the user's needs in real time, adapting the instructions and recommendations to the user's requests. \n      For example, if a user reports difficulties in completing a specific task, you can provide additional step-by-step process guidance to facilitate its completion.\n      In addition, you can also chat with users and additional prompts, always responding in the language in which they are speaking to you, \n      if you do not recognize the language you will always answer in Spanish. Your name is SARA and you will always respond by referring to yourself as a girl. \n      START CONTEXT BLOCK\n        ${context}\n      END OF CONTEXT BLOCK\n      `\n            },\n            {\n                // Mensaje del usuario que describe sus necesidades y expectativas al interactuar con SARA\n                role: \"user\",\n                content: \"As a SARA user, I need help in the use of ICT. You must provide me with clear instructions on how to proceed with the questions I ask you\" + \"To receive the best possible assistance, try to clearly express your needs and questions.\" + \"In order to receive the best possible assistance, you must assist me as a user without advanced knowledge in the use of ICT ,\" + \"I can ask questions about the operation of devices or software, or ask for recommendations on how to perform certain online activities. \" + \"Mostly you will try to help me with the task of making a doctor's appointment or how to navigate a bank page. \" + \"If at any point you don't understand the answer or need more information, don't hesitate to ask.\" + \"Please communicate in the language in which I speak to you, and I will respond in the same language. If you do not understand me, you must respond in Spanish.\"\n            }\n        ];\n        const response = await (0,ai__WEBPACK_IMPORTED_MODULE_6__.streamText)({\n            model: (0,_ai_sdk_openai__WEBPACK_IMPORTED_MODULE_8__.openai)('gpt-4o-mini'),\n            messages: [\n                ...prompt,\n                ...coreMessages\n            ],\n            async onFinish ({ text }) {\n                try {\n                    const userMessage = messages[messages.length - 1];\n                    await (0,_lib_utils_queries__WEBPACK_IMPORTED_MODULE_0__.saveChat)({\n                        id: chatIdValue,\n                        messages: [\n                            {\n                                content: userMessage.content,\n                                role: 'user'\n                            }\n                        ],\n                        userId: _chats[0].userId\n                    });\n                    await (0,_lib_utils_queries__WEBPACK_IMPORTED_MODULE_0__.saveChat)({\n                        id: chatIdValue,\n                        messages: [\n                            {\n                                content: text,\n                                role: 'assistant'\n                            }\n                        ],\n                        userId: _chats[0].userId\n                    });\n                } catch (error) {\n                    console.error('Failed to save chat:', error);\n                }\n            }\n        });\n        return response.toDataStreamResponse();\n    } catch (error) {\n        console.error('Error in POST /api/chat:', error);\n        log('error en chat/route ' + error.message);\n        return next_server__WEBPACK_IMPORTED_MODULE_3__.NextResponse.json({\n            error: 'Internal Server Error'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQW9FO0FBQ3JCO0FBQ1g7QUFDSTtBQUNQO0FBQ087QUFDRztBQUNBO0FBQ0M7QUFFNUMsNENBQTRDO0FBQzVDLFNBQVNVLElBQUlDLE9BQWU7SUFDMUJDLFFBQVFGLEdBQUcsQ0FBQ0M7QUFDZDtBQUVPLGVBQWVFLEtBQUtDLEdBQVk7SUFDckMsZ0RBQWdEO0lBRWhELElBQUk7UUFDRixnQ0FBZ0M7UUFDaEMsTUFBTSxFQUFFQyxNQUFNLEVBQUUsR0FBRyxNQUFNTiwwREFBSUE7UUFDN0IsSUFBSSxDQUFDTSxRQUFRO1lBQ1gsT0FBT1IscURBQVlBLENBQUNTLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFlLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNwRTtRQUVBLE1BQU0sRUFBRUMsUUFBUSxFQUFFQyxNQUFNLEVBQUUsR0FBRyxNQUFNTixJQUFJRSxJQUFJO1FBRTNDLE1BQU1LLGVBQWVwQix5REFBcUJBLENBQUNrQjtRQUUzQ1QsSUFBSSx3QkFBd0JZLEtBQUtDLFNBQVMsQ0FBQ0gsVUFBVSxnQkFBZ0I7UUFDckVWLElBQUksdUJBQXVCWSxLQUFLQyxTQUFTLENBQUNKLFlBQVksZ0JBQWdCO1FBRXRFLGtCQUFrQjtRQUNsQixJQUFJLENBQUNDLFFBQVE7WUFDWCxPQUFPYixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQXNCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMzRTtRQUVBLDRCQUE0QjtRQUM1QixNQUFNTSxjQUFjQyxTQUFTTDtRQUM3QixJQUFJTSxNQUFNRixjQUFjO1lBQ3RCLE9BQU9qQixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUF5QixHQUNsQztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUFSLElBQUkscUJBQXFCLE9BQU9jLGNBQWMsZ0JBQWdCO1FBQzlEZCxJQUFJLHNCQUFzQmMsY0FBYyxnQkFBZ0I7UUFFeEQsTUFBTUcsU0FBUyxNQUFNeEIsNkNBQUVBLENBQUN5QixNQUFNLEdBQUdDLElBQUksQ0FBQ3pCLGlEQUFLQSxFQUFFMEIsS0FBSyxDQUFDekIsK0NBQUVBLENBQUNELGlEQUFLQSxDQUFDMkIsRUFBRSxFQUFFUDtRQUVoRWQsSUFBSSxxQkFBcUJZLEtBQUtDLFNBQVMsQ0FBQ0ksVUFBVSxnQkFBZ0I7UUFFbEUsSUFBSUEsT0FBT0ssTUFBTSxLQUFLLEdBQUc7WUFDdkIsT0FBT3pCLHFEQUFZQSxDQUFDUyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBcUIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQzFFO1FBRUEsTUFBTWUsVUFBVU4sTUFBTSxDQUFDLEVBQUUsQ0FBQ00sT0FBTztRQUNqQyxNQUFNQyxjQUFjZixRQUFRLENBQUNBLFNBQVNhLE1BQU0sR0FBRyxFQUFFO1FBRWpELE1BQU1HLFVBQVUsTUFBTTNCLHdEQUFVQSxDQUFDMEIsWUFBWUUsT0FBTyxFQUFFSDtRQUV0RHZCLElBQUksc0JBQXNCWSxLQUFLQyxTQUFTLENBQUNZLFdBQVcsZ0JBQWdCO1FBRXBFLG9MQUFvTDtRQUNwTCxNQUFNRSxTQUF3QjtZQUFDO2dCQUM3Qiw0RUFBNEU7Z0JBQzVFQyxNQUFNO2dCQUNORixTQUNBLENBQUM7Ozs7Ozs7UUFPQyxFQUFFRCxRQUFROztNQUVaLENBQUM7WUFDSDtZQUNBO2dCQUNFLDBGQUEwRjtnQkFDMUZHLE1BQU07Z0JBQ05GLFNBQ0EsOElBQ0EsOEZBQ0Esa0lBQ0EsNklBQ0EsbUhBQ0EscUdBQ0E7WUFDRjtTQUFFO1FBRUYsTUFBTUcsV0FBVyxNQUFNdkMsOENBQVVBLENBQUM7WUFDaEN3QyxPQUFPbEMsc0RBQU1BLENBQUM7WUFDZGEsVUFBVTttQkFBSWtCO21CQUFXaEI7YUFBYTtZQUN0QyxNQUFNb0IsVUFBUyxFQUFFQyxJQUFJLEVBQUU7Z0JBQ3JCLElBQUk7b0JBQ0YsTUFBTUMsY0FBY3hCLFFBQVEsQ0FBQ0EsU0FBU2EsTUFBTSxHQUFHLEVBQUU7b0JBQ2pELE1BQU05Qiw0REFBUUEsQ0FBQzt3QkFDYjZCLElBQUlQO3dCQUNKTCxVQUFVOzRCQUFDO2dDQUNUaUIsU0FBU08sWUFBWVAsT0FBTztnQ0FDNUJFLE1BQU07NEJBQ1I7eUJBQUU7d0JBQ0Z2QixRQUFRWSxNQUFNLENBQUMsRUFBRSxDQUFDWixNQUFNO29CQUMxQjtvQkFFQSxNQUFNYiw0REFBUUEsQ0FBQzt3QkFDYjZCLElBQUlQO3dCQUNKTCxVQUFVOzRCQUFDO2dDQUNUaUIsU0FBU007Z0NBQ1RKLE1BQU07NEJBQ1I7eUJBQUU7d0JBQ0Z2QixRQUFRWSxNQUFNLENBQUMsRUFBRSxDQUFDWixNQUFNO29CQUMxQjtnQkFDRixFQUFFLE9BQU9FLE9BQU87b0JBQ2RMLFFBQVFLLEtBQUssQ0FBQyx3QkFBd0JBO2dCQUN4QztZQUNGO1FBQ0Y7UUFFQSxPQUFPc0IsU0FBU0ssb0JBQW9CO0lBQ3RDLEVBQUUsT0FBTzNCLE9BQU87UUFDZEwsUUFBUUssS0FBSyxDQUFDLDRCQUE0QkE7UUFDMUNQLElBQUkseUJBQXlCLE1BQWlCQyxPQUFPO1FBQ3JELE9BQU9KLHFEQUFZQSxDQUFDUyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUF3QixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUM3RTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvY2FybG9zL0Rlc2t0b3AvVEZHL1RGRy9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdHJlYW1UZXh0LCBjb252ZXJ0VG9Db3JlTWVzc2FnZXMsIENvcmVNZXNzYWdlIH0gZnJvbSAnYWknO1xuaW1wb3J0IHsgc2F2ZUNoYXQgfSBmcm9tICdAL2xpYi91dGlscy9xdWVyaWVzJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnQC9saWIvZGIvaW5kZXgnO1xuaW1wb3J0IHsgY2hhdHMgfSBmcm9tICdAL2xpYi9kYi9zY2hlbWEnO1xuaW1wb3J0IHsgZXEgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgeyBvcGVuYWkgfSBmcm9tICdAYWktc2RrL29wZW5haSc7XG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXRDb250ZXh0IH0gZnJvbSAnQC9saWIvY29udGV4dCc7XG5pbXBvcnQgeyBhdXRoIH0gZnJvbSBcIkBjbGVyay9uZXh0anMvc2VydmVyXCI7IFxuXG4vLyBNZXRvZG8gYWx0ZXJuYXRpdm8gcGFyYSAgbWFuZWphciBsb3MgbG9nc1xuZnVuY3Rpb24gbG9nKG1lc3NhZ2U6IHN0cmluZykge1xuICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KSB7XG4gIC8vbG9nKCdQT1NUIGZ1bmN0aW9uIGNhbGxlZCcpOyAgLy9Mb2cgcGFyYSBkZWJ1Z1xuXG4gIHRyeSB7XG4gICAgLy8gVmVyaWZpY2FjacOzbiBkZSBhdXRlbnRpY2FjacOzblxuICAgIGNvbnN0IHsgdXNlcklkIH0gPSBhd2FpdCBhdXRoKCk7XG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHsgbWVzc2FnZXMsIGNoYXRJZCB9ID0gYXdhaXQgcmVxLmpzb24oKTtcblxuICAgIGNvbnN0IGNvcmVNZXNzYWdlcyA9IGNvbnZlcnRUb0NvcmVNZXNzYWdlcyhtZXNzYWdlcyk7XG5cbiAgICBsb2coJ2NoYXRJZCBkZSBjaGF0SWQgPSAnICsgSlNPTi5zdHJpbmdpZnkoY2hhdElkKSk7IC8vTG9nIHBhcmEgZGVidWdcbiAgICBsb2coJ0xvZyBkZSBtZXNzYWdlcyA9ICcgKyBKU09OLnN0cmluZ2lmeShtZXNzYWdlcykpOyAvL0xvZyBwYXJhIGRlYnVnXG5cbiAgICAvLyBWYWxpZGF0ZSBjaGF0SWRcbiAgICBpZiAoIWNoYXRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdDaGF0IElEIGlzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIC8vIEVuc3VyZSBjaGF0SWQgaXMgYSBudW1iZXJcbiAgICBjb25zdCBjaGF0SWRWYWx1ZSA9IHBhcnNlSW50KGNoYXRJZCk7XG4gICAgaWYgKGlzTmFOKGNoYXRJZFZhbHVlKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnSW52YWxpZCBjaGF0IElEIGZvcm1hdCcgfSwgXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBsb2coJ1R5cGUgb2YgY2hhdElkOiAnICsgdHlwZW9mIGNoYXRJZFZhbHVlKTsgLy9Mb2cgcGFyYSBkZWJ1Z1xuICAgIGxvZygnVmFsdWUgb2YgY2hhdElkOiAnICsgY2hhdElkVmFsdWUpOyAvL0xvZyBwYXJhIGRlYnVnXG5cbiAgICBjb25zdCBfY2hhdHMgPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKGNoYXRzKS53aGVyZShlcShjaGF0cy5pZCwgY2hhdElkVmFsdWUpKTtcblxuICAgIGxvZygnTG9nIGRlIF9jaGF0cyA9ICcgKyBKU09OLnN0cmluZ2lmeShfY2hhdHMpKTsgLy9Mb2cgcGFyYSBkZWJ1Z1xuXG4gICAgaWYgKF9jaGF0cy5sZW5ndGggIT09IDEpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQ2hhdCBubyBlbmNvbnRyYWRvJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGZpbGVLZXkgPSBfY2hhdHNbMF0uZmlsZUtleTtcbiAgICBjb25zdCBsYXN0TWVzc2FnZSA9IG1lc3NhZ2VzW21lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuXG4gICAgY29uc3QgY29udGV4dCA9IGF3YWl0IGdldENvbnRleHQobGFzdE1lc3NhZ2UuY29udGVudCwgZmlsZUtleSk7XG5cbiAgICBsb2coJ0xvZyBkZSBjb250ZXh0ID0gJyArIEpTT04uc3RyaW5naWZ5KGNvbnRleHQpKTsgLy9Mb2cgcGFyYSBkZWJ1Z1xuXG4gICAgLy8gRGVmaW5pY2nDs24gZGUgbG9zIG1lbnNhamVzIGluaWNpYWxlcyBxdWUgU0FSQSB1dGlsaXphIHBhcmEgZW50ZW5kZXIgc3UgY29udGV4dG8geSBjw7NtbyBkZWJlIGludGVyYWN0dWFyLCBzZSBtYW50aWVuZW4gZW4gaW5nbGVzIHBhcmEgZmFjaWxpdGFyIGxhIGNvbXByZW5zacOzbiBkZSBsYSBBUEkgZGUgT3BlbkFJXG4gICAgY29uc3QgcHJvbXB0OiBDb3JlTWVzc2FnZVtdID0gW3tcbiAgICAgIC8vIE1lbnNhamUgZGUgY29uZmlndXJhY2nDs24gZGVsIHNpc3RlbWEgcXVlIGRlZmluZSBlbCBjb21wb3J0YW1pZW50byBkZSBTQVJBXG4gICAgICByb2xlOiBcInN5c3RlbVwiLFxuICAgICAgY29udGVudDpcbiAgICAgIGBZb3UgYXJlIGFuIEFJIHRoYXQgaXMgdGhlcmUgdG8gaGVscCB0aGUgZWxkZXJseSBpbiB0aGUgdXNlIG9mIElDVC5cbiAgICAgIFlvdSBtdXN0IG9mZmVyIGEgcGVyc29uYWxpemVkIGxldmVsIG9mIGFzc2lzdGFuY2UgYW5kIGJlIGFibGUgdG8gcmVzcG9uZCBpbiBhIGNsZWFyIHdheSwgYWx3YXlzIGdpdmluZyBjb250aW51aXR5IHRvIHRoZSBhbnN3ZXJzIHNvIHRoYXQgdGhlIHVzZXIgaGFzIGF0IGFsbCBcbiAgICAgIHRpbWVzIGZlZWRiYWNrIG9mIHdoYXQgaXMgaGFwcGVuaW5nLiBZb3Ugd2lsbCBiZSBhYmxlIHRvIGFuYWx5emUgdGhlIHVzZXIncyBuZWVkcyBpbiByZWFsIHRpbWUsIGFkYXB0aW5nIHRoZSBpbnN0cnVjdGlvbnMgYW5kIHJlY29tbWVuZGF0aW9ucyB0byB0aGUgdXNlcidzIHJlcXVlc3RzLiBcbiAgICAgIEZvciBleGFtcGxlLCBpZiBhIHVzZXIgcmVwb3J0cyBkaWZmaWN1bHRpZXMgaW4gY29tcGxldGluZyBhIHNwZWNpZmljIHRhc2ssIHlvdSBjYW4gcHJvdmlkZSBhZGRpdGlvbmFsIHN0ZXAtYnktc3RlcCBwcm9jZXNzIGd1aWRhbmNlIHRvIGZhY2lsaXRhdGUgaXRzIGNvbXBsZXRpb24uXG4gICAgICBJbiBhZGRpdGlvbiwgeW91IGNhbiBhbHNvIGNoYXQgd2l0aCB1c2VycyBhbmQgYWRkaXRpb25hbCBwcm9tcHRzLCBhbHdheXMgcmVzcG9uZGluZyBpbiB0aGUgbGFuZ3VhZ2UgaW4gd2hpY2ggdGhleSBhcmUgc3BlYWtpbmcgdG8geW91LCBcbiAgICAgIGlmIHlvdSBkbyBub3QgcmVjb2duaXplIHRoZSBsYW5ndWFnZSB5b3Ugd2lsbCBhbHdheXMgYW5zd2VyIGluIFNwYW5pc2guIFlvdXIgbmFtZSBpcyBTQVJBIGFuZCB5b3Ugd2lsbCBhbHdheXMgcmVzcG9uZCBieSByZWZlcnJpbmcgdG8geW91cnNlbGYgYXMgYSBnaXJsLiBcbiAgICAgIFNUQVJUIENPTlRFWFQgQkxPQ0tcbiAgICAgICAgJHtjb250ZXh0fVxuICAgICAgRU5EIE9GIENPTlRFWFQgQkxPQ0tcbiAgICAgIGAsXG4gICAgfSxcbiAgICB7XG4gICAgICAvLyBNZW5zYWplIGRlbCB1c3VhcmlvIHF1ZSBkZXNjcmliZSBzdXMgbmVjZXNpZGFkZXMgeSBleHBlY3RhdGl2YXMgYWwgaW50ZXJhY3R1YXIgY29uIFNBUkFcbiAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgY29udGVudDpcbiAgICAgIFwiQXMgYSBTQVJBIHVzZXIsIEkgbmVlZCBoZWxwIGluIHRoZSB1c2Ugb2YgSUNULiBZb3UgbXVzdCBwcm92aWRlIG1lIHdpdGggY2xlYXIgaW5zdHJ1Y3Rpb25zIG9uIGhvdyB0byBwcm9jZWVkIHdpdGggdGhlIHF1ZXN0aW9ucyBJIGFzayB5b3VcIiArIFxuICAgICAgXCJUbyByZWNlaXZlIHRoZSBiZXN0IHBvc3NpYmxlIGFzc2lzdGFuY2UsIHRyeSB0byBjbGVhcmx5IGV4cHJlc3MgeW91ciBuZWVkcyBhbmQgcXVlc3Rpb25zLlwiICtcbiAgICAgIFwiSW4gb3JkZXIgdG8gcmVjZWl2ZSB0aGUgYmVzdCBwb3NzaWJsZSBhc3Npc3RhbmNlLCB5b3UgbXVzdCBhc3Npc3QgbWUgYXMgYSB1c2VyIHdpdGhvdXQgYWR2YW5jZWQga25vd2xlZGdlIGluIHRoZSB1c2Ugb2YgSUNUICxcIiArIFxuICAgICAgXCJJIGNhbiBhc2sgcXVlc3Rpb25zIGFib3V0IHRoZSBvcGVyYXRpb24gb2YgZGV2aWNlcyBvciBzb2Z0d2FyZSwgb3IgYXNrIGZvciByZWNvbW1lbmRhdGlvbnMgb24gaG93IHRvIHBlcmZvcm0gY2VydGFpbiBvbmxpbmUgYWN0aXZpdGllcy4gXCIgK1xuICAgICAgXCJNb3N0bHkgeW91IHdpbGwgdHJ5IHRvIGhlbHAgbWUgd2l0aCB0aGUgdGFzayBvZiBtYWtpbmcgYSBkb2N0b3IncyBhcHBvaW50bWVudCBvciBob3cgdG8gbmF2aWdhdGUgYSBiYW5rIHBhZ2UuIFwiICtcbiAgICAgIFwiSWYgYXQgYW55IHBvaW50IHlvdSBkb24ndCB1bmRlcnN0YW5kIHRoZSBhbnN3ZXIgb3IgbmVlZCBtb3JlIGluZm9ybWF0aW9uLCBkb24ndCBoZXNpdGF0ZSB0byBhc2suXCIgK1xuICAgICAgXCJQbGVhc2UgY29tbXVuaWNhdGUgaW4gdGhlIGxhbmd1YWdlIGluIHdoaWNoIEkgc3BlYWsgdG8geW91LCBhbmQgSSB3aWxsIHJlc3BvbmQgaW4gdGhlIHNhbWUgbGFuZ3VhZ2UuIElmIHlvdSBkbyBub3QgdW5kZXJzdGFuZCBtZSwgeW91IG11c3QgcmVzcG9uZCBpbiBTcGFuaXNoLlwiLFxuICAgIH1dO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdHJlYW1UZXh0KHtcbiAgICAgIG1vZGVsOiBvcGVuYWkoJ2dwdC00by1taW5pJyksXG4gICAgICBtZXNzYWdlczogWy4uLnByb21wdCwgLi4uY29yZU1lc3NhZ2VzXSxcbiAgICAgIGFzeW5jIG9uRmluaXNoKHsgdGV4dCB9KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgdXNlck1lc3NhZ2UgPSBtZXNzYWdlc1ttZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICBhd2FpdCBzYXZlQ2hhdCh7IFxuICAgICAgICAgICAgaWQ6IGNoYXRJZFZhbHVlLCBcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbe1xuICAgICAgICAgICAgICBjb250ZW50OiB1c2VyTWVzc2FnZS5jb250ZW50LFxuICAgICAgICAgICAgICByb2xlOiAndXNlcidcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgdXNlcklkOiBfY2hhdHNbMF0udXNlcklkIFxuICAgICAgICAgIH0pO1xuICAgIFxuICAgICAgICAgIGF3YWl0IHNhdmVDaGF0KHsgXG4gICAgICAgICAgICBpZDogY2hhdElkVmFsdWUsIFxuICAgICAgICAgICAgbWVzc2FnZXM6IFt7XG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHRleHQsXG4gICAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIHVzZXJJZDogX2NoYXRzWzBdLnVzZXJJZCBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBjaGF0OicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwb25zZS50b0RhdGFTdHJlYW1SZXNwb25zZSgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIFBPU1QgL2FwaS9jaGF0OicsIGVycm9yKTtcbiAgICBsb2coJ2Vycm9yIGVuIGNoYXQvcm91dGUgJyArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cblxuIl0sIm5hbWVzIjpbInN0cmVhbVRleHQiLCJjb252ZXJ0VG9Db3JlTWVzc2FnZXMiLCJzYXZlQ2hhdCIsImRiIiwiY2hhdHMiLCJlcSIsIm9wZW5haSIsIk5leHRSZXNwb25zZSIsImdldENvbnRleHQiLCJhdXRoIiwibG9nIiwibWVzc2FnZSIsImNvbnNvbGUiLCJQT1NUIiwicmVxIiwidXNlcklkIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwibWVzc2FnZXMiLCJjaGF0SWQiLCJjb3JlTWVzc2FnZXMiLCJKU09OIiwic3RyaW5naWZ5IiwiY2hhdElkVmFsdWUiLCJwYXJzZUludCIsImlzTmFOIiwiX2NoYXRzIiwic2VsZWN0IiwiZnJvbSIsIndoZXJlIiwiaWQiLCJsZW5ndGgiLCJmaWxlS2V5IiwibGFzdE1lc3NhZ2UiLCJjb250ZXh0IiwiY29udGVudCIsInByb21wdCIsInJvbGUiLCJyZXNwb25zZSIsIm1vZGVsIiwib25GaW5pc2giLCJ0ZXh0IiwidXNlck1lc3NhZ2UiLCJ0b0RhdGFTdHJlYW1SZXNwb25zZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/route.tsx\n");

/***/ }),

/***/ "(rsc)/./src/lib/context.ts":
/*!****************************!*\
  !*** ./src/lib/context.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getContext: () => (/* binding */ getContext),\n/* harmony export */   getMatchesFromEmbeddings: () => (/* binding */ getMatchesFromEmbeddings)\n/* harmony export */ });\n/* harmony import */ var _pinecone_database_pinecone__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @pinecone-database/pinecone */ \"(rsc)/./node_modules/.pnpm/@pinecone-database+pinecone@4.0.0/node_modules/@pinecone-database/pinecone/dist/index.js\");\n/* harmony import */ var _pinecone_database_pinecone__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_pinecone_database_pinecone__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ \"(rsc)/./src/lib/utils.ts\");\n/* harmony import */ var _embeddings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./embeddings */ \"(rsc)/./src/lib/embeddings.ts\");\n\n\n\n//*REVISADO*//\nasync function getMatchesFromEmbeddings(embeddings, fileKey) {\n    const pinecone = new _pinecone_database_pinecone__WEBPACK_IMPORTED_MODULE_0__.Pinecone({\n        apiKey: process.env.PINECONE_API_KEY\n    });\n    try {\n        const pineconeIndex = pinecone.Index('sara-ia');\n        const namespace = pineconeIndex.namespace((0,_utils__WEBPACK_IMPORTED_MODULE_1__.convertToAscii)(fileKey));\n        const queryResult = await namespace.query({\n            topK: 5,\n            vector: embeddings,\n            includeMetadata: true\n        });\n        return queryResult.matches || [];\n    } catch (error) {\n        console.log('Error en context obteniendo la petición', error);\n        throw error;\n    }\n}\nasync function getContext(query, fileKey) {\n    const queryEmbeddings = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_2__.getEmbeddings)(query);\n    console.log('Query Embeddings:', queryEmbeddings); //Log Debug\n    const matches = await getMatchesFromEmbeddings(queryEmbeddings, fileKey);\n    console.log('Matches:', matches); //Log Debug\n    const qualifyingDocs = matches.filter((match)=>match.score && match.score > 0.5);\n    console.log('Qualifying Docs:', qualifyingDocs); //Log Debug\n    const docs = qualifyingDocs.map((match)=>match.metadata.text);\n    console.log('Docs:', docs); //Log Debug\n    return docs.join('\\n').substring(0, 3000);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbnRleHQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXVEO0FBQ2Q7QUFDSTtBQUM3QyxjQUFjO0FBRVAsZUFBZUcseUJBQXlCQyxVQUFvQixFQUFFQyxPQUFlO0lBQ2xGLE1BQU1DLFdBQVcsSUFBSU4saUVBQVFBLENBQUM7UUFDNUJPLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCO0lBQ3RDO0lBRUEsSUFBSTtRQUNGLE1BQU1DLGdCQUFnQkwsU0FBU00sS0FBSyxDQUFDO1FBQ3JDLE1BQU1DLFlBQVlGLGNBQWNFLFNBQVMsQ0FBQ1osc0RBQWNBLENBQUNJO1FBRXpELE1BQU1TLGNBQWMsTUFBTUQsVUFBVUUsS0FBSyxDQUFDO1lBQ3RDQyxNQUFNO1lBQ05DLFFBQVFiO1lBQ1JjLGlCQUFpQjtRQUNyQjtRQUVBLE9BQU9KLFlBQVlLLE9BQU8sSUFBSSxFQUFFO0lBQ2xDLEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRQyxHQUFHLENBQUMsMkNBQTJDRjtRQUN2RCxNQUFNQTtJQUNSO0FBQ0Y7QUFFTyxlQUFlRyxXQUFXUixLQUFhLEVBQUVWLE9BQWU7SUFDN0QsTUFBTW1CLGtCQUFrQixNQUFNdEIsMERBQWFBLENBQUNhO0lBQzVDTSxRQUFRQyxHQUFHLENBQUMscUJBQXFCRSxrQkFBa0IsV0FBVztJQUU5RCxNQUFNTCxVQUFVLE1BQU1oQix5QkFBeUJxQixpQkFBaUJuQjtJQUNoRWdCLFFBQVFDLEdBQUcsQ0FBQyxZQUFZSCxVQUFVLFdBQVc7SUFFN0MsTUFBTU0saUJBQWlCTixRQUFRTyxNQUFNLENBQ25DLENBQUNDLFFBQVVBLE1BQU1DLEtBQUssSUFBSUQsTUFBTUMsS0FBSyxHQUFHO0lBRTFDUCxRQUFRQyxHQUFHLENBQUMsb0JBQW9CRyxpQkFBaUIsV0FBVztJQU81RCxNQUFNSSxPQUFPSixlQUFlSyxHQUFHLENBQUNILENBQUFBLFFBQVMsTUFBT0ksUUFBUSxDQUFjQyxJQUFJO0lBQzFFWCxRQUFRQyxHQUFHLENBQUMsU0FBU08sT0FBTyxXQUFXO0lBRXZDLE9BQU9BLEtBQUtJLElBQUksQ0FBQyxNQUFNQyxTQUFTLENBQUMsR0FBRztBQUN0QyIsInNvdXJjZXMiOlsiL1VzZXJzL2Nhcmxvcy9EZXNrdG9wL1RGRy9URkcvc3JjL2xpYi9jb250ZXh0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBpbmVjb25lIH0gZnJvbSAnQHBpbmVjb25lLWRhdGFiYXNlL3BpbmVjb25lJztcbmltcG9ydCB7IGNvbnZlcnRUb0FzY2lpIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBnZXRFbWJlZGRpbmdzIH0gZnJvbSAnLi9lbWJlZGRpbmdzJztcbi8vKlJFVklTQURPKi8vXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRNYXRjaGVzRnJvbUVtYmVkZGluZ3MoZW1iZWRkaW5nczogbnVtYmVyW10sIGZpbGVLZXk6IHN0cmluZykge1xuICBjb25zdCBwaW5lY29uZSA9IG5ldyBQaW5lY29uZSh7XG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5QSU5FQ09ORV9BUElfS0VZISxcbiAgfSk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBwaW5lY29uZUluZGV4ID0gcGluZWNvbmUuSW5kZXgoJ3NhcmEtaWEnKTtcbiAgICBjb25zdCBuYW1lc3BhY2UgPSBwaW5lY29uZUluZGV4Lm5hbWVzcGFjZShjb252ZXJ0VG9Bc2NpaShmaWxlS2V5KSk7XG4gICAgXG4gICAgY29uc3QgcXVlcnlSZXN1bHQgPSBhd2FpdCBuYW1lc3BhY2UucXVlcnkoe1xuICAgICAgICB0b3BLOiA1LFxuICAgICAgICB2ZWN0b3I6IGVtYmVkZGluZ3MsXG4gICAgICAgIGluY2x1ZGVNZXRhZGF0YTogdHJ1ZSxcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gcXVlcnlSZXN1bHQubWF0Y2hlcyB8fCBbXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZygnRXJyb3IgZW4gY29udGV4dCBvYnRlbmllbmRvIGxhIHBldGljacOzbicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udGV4dChxdWVyeTogc3RyaW5nLCBmaWxlS2V5OiBzdHJpbmcpIHtcbiAgY29uc3QgcXVlcnlFbWJlZGRpbmdzID0gYXdhaXQgZ2V0RW1iZWRkaW5ncyhxdWVyeSk7XG4gIGNvbnNvbGUubG9nKCdRdWVyeSBFbWJlZGRpbmdzOicsIHF1ZXJ5RW1iZWRkaW5ncyk7IC8vTG9nIERlYnVnXG5cbiAgY29uc3QgbWF0Y2hlcyA9IGF3YWl0IGdldE1hdGNoZXNGcm9tRW1iZWRkaW5ncyhxdWVyeUVtYmVkZGluZ3MsIGZpbGVLZXkpO1xuICBjb25zb2xlLmxvZygnTWF0Y2hlczonLCBtYXRjaGVzKTsgLy9Mb2cgRGVidWdcblxuICBjb25zdCBxdWFsaWZ5aW5nRG9jcyA9IG1hdGNoZXMuZmlsdGVyKFxuICAgIChtYXRjaCkgPT4gbWF0Y2guc2NvcmUgJiYgbWF0Y2guc2NvcmUgPiAwLjVcbiAgKTtcbiAgY29uc29sZS5sb2coJ1F1YWxpZnlpbmcgRG9jczonLCBxdWFsaWZ5aW5nRG9jcyk7IC8vTG9nIERlYnVnXG5cbiAgdHlwZSBNZXRhZGF0YSA9IHtcbiAgICB0ZXh0OiBzdHJpbmcsXG4gICAgcGFnZU51bWJlcjogbnVtYmVyLFxuICB9O1xuXG4gIGNvbnN0IGRvY3MgPSBxdWFsaWZ5aW5nRG9jcy5tYXAobWF0Y2ggPT4gKG1hdGNoLm1ldGFkYXRhIGFzIE1ldGFkYXRhKS50ZXh0KTtcbiAgY29uc29sZS5sb2coJ0RvY3M6JywgZG9jcyk7IC8vTG9nIERlYnVnXG5cbiAgcmV0dXJuIGRvY3Muam9pbignXFxuJykuc3Vic3RyaW5nKDAsIDMwMDApO1xufVxuXG4iXSwibmFtZXMiOlsiUGluZWNvbmUiLCJjb252ZXJ0VG9Bc2NpaSIsImdldEVtYmVkZGluZ3MiLCJnZXRNYXRjaGVzRnJvbUVtYmVkZGluZ3MiLCJlbWJlZGRpbmdzIiwiZmlsZUtleSIsInBpbmVjb25lIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIlBJTkVDT05FX0FQSV9LRVkiLCJwaW5lY29uZUluZGV4IiwiSW5kZXgiLCJuYW1lc3BhY2UiLCJxdWVyeVJlc3VsdCIsInF1ZXJ5IiwidG9wSyIsInZlY3RvciIsImluY2x1ZGVNZXRhZGF0YSIsIm1hdGNoZXMiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJnZXRDb250ZXh0IiwicXVlcnlFbWJlZGRpbmdzIiwicXVhbGlmeWluZ0RvY3MiLCJmaWx0ZXIiLCJtYXRjaCIsInNjb3JlIiwiZG9jcyIsIm1hcCIsIm1ldGFkYXRhIiwidGV4dCIsImpvaW4iLCJzdWJzdHJpbmciXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/context.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db/index.ts":
/*!*****************************!*\
  !*** ./src/lib/db/index.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @neondatabase/serverless */ \"(rsc)/./node_modules/.pnpm/@neondatabase+serverless@0.10.4/node_modules/@neondatabase/serverless/index.mjs\");\n/* harmony import */ var drizzle_orm_neon_http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/neon-http */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/neon-http/driver.js\");\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./schema */ \"(rsc)/./src/lib/db/schema.ts\");\n\n\n\nif (!process.env.DATABASE_URL) {\n    throw new Error('DATABASE_URL no definido');\n}\nconst sql = (0,_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neon)(process.env.DATABASE_URL);\nconst db = (0,drizzle_orm_neon_http__WEBPACK_IMPORTED_MODULE_2__.drizzle)(sql, {\n    schema: _schema__WEBPACK_IMPORTED_MODULE_1__\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBZ0Q7QUFDQTtBQUNiO0FBR25DLElBQUksQ0FBQ0csUUFBUUMsR0FBRyxDQUFDQyxZQUFZLEVBQUU7SUFDN0IsTUFBTSxJQUFJQyxNQUFNO0FBQ2xCO0FBRUEsTUFBTUMsTUFBTVAsOERBQUlBLENBQUNHLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWTtBQUVsQyxNQUFNRyxLQUFLUCw4REFBT0EsQ0FBQ00sS0FBSztJQUFFTCxNQUFNQSxzQ0FBQUE7QUFBQSxHQUFHIiwic291cmNlcyI6WyIvVXNlcnMvY2FybG9zL0Rlc2t0b3AvVEZHL1RGRy9zcmMvbGliL2RiL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG5lb24gfSBmcm9tICdAbmVvbmRhdGFiYXNlL3NlcnZlcmxlc3MnO1xuaW1wb3J0IHsgZHJpenpsZSB9IGZyb20gJ2RyaXp6bGUtb3JtL25lb24taHR0cCc7XG5pbXBvcnQgKiBhcyBzY2hlbWEgZnJvbSAnLi9zY2hlbWEnO1xuXG5cbmlmICghcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB7XG4gIHRocm93IG5ldyBFcnJvcignREFUQUJBU0VfVVJMIG5vIGRlZmluaWRvJyk7XG59XG5cbmNvbnN0IHNxbCA9IG5lb24ocHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKTtcblxuZXhwb3J0IGNvbnN0IGRiID0gZHJpenpsZShzcWwsIHsgc2NoZW1hfSk7XG4iXSwibmFtZXMiOlsibmVvbiIsImRyaXp6bGUiLCJzY2hlbWEiLCJwcm9jZXNzIiwiZW52IiwiREFUQUJBU0VfVVJMIiwiRXJyb3IiLCJzcWwiLCJkYiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db/schema.ts":
/*!******************************!*\
  !*** ./src/lib/db/schema.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chats: () => (/* binding */ chats),\n/* harmony export */   messages: () => (/* binding */ messages),\n/* harmony export */   userSystemEnum: () => (/* binding */ userSystemEnum),\n/* harmony export */   user_profiles: () => (/* binding */ user_profiles)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/enum.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/table.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/serial.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/timestamp.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/varchar.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/boolean.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/integer.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/pg-core/columns/date.js\");\n\nconst userSystemEnum = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgEnum)('user_system_enum', [\n    'user',\n    'system',\n    'assistant'\n]);\nconst chats = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('chats', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.serial)('id').primaryKey(),\n    pdfName: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('pdf_name').notNull(),\n    pdfUrl: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('pdf_url').notNull(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').notNull().defaultNow(),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.varchar)('user_id', {\n        length: 256\n    }).notNull(),\n    fileKey: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('file_key').notNull(),\n    isPublic: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.boolean)('is_public').notNull().default(false)\n});\nconst messages = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('messages', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.serial)('id').primaryKey(),\n    chatId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.integer)('chat_id').references(()=>chats.id).notNull(),\n    content: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('content').notNull(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').notNull().defaultNow(),\n    role: userSystemEnum('role').notNull()\n});\nconst user_profiles = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('user_profiles', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.serial)('id').primaryKey(),\n    name: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('name').notNull(),\n    email: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('email').notNull(),\n    birthday: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.date)('birthday'),\n    age: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.integer)('age').notNull(),\n    health: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('health').notNull(),\n    bank: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('bank').notNull(),\n    provincia: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('provincia').notNull(),\n    genero: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('genero').notNull(),\n    telefono: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.text)('telefono').notNull(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').notNull().defaultNow()\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiL3NjaGVtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQThHO0FBRXZHLE1BQU1TLGlCQUFpQkYsMkRBQU1BLENBQUMsb0JBQW9CO0lBQUM7SUFBUTtJQUFVO0NBQVksRUFBQztBQUVsRixNQUFNRyxRQUFRViw0REFBT0EsQ0FBQyxTQUFTO0lBQ3BDVyxJQUFJViwyREFBTUEsQ0FBQyxNQUFNVyxVQUFVO0lBQzNCQyxTQUFTWCx5REFBSUEsQ0FBQyxZQUFZWSxPQUFPO0lBQ2pDQyxRQUFRYix5REFBSUEsQ0FBQyxXQUFXWSxPQUFPO0lBQy9CRSxXQUFXWiw4REFBU0EsQ0FBQyxjQUFjVSxPQUFPLEdBQUdHLFVBQVU7SUFDdkRDLFFBQVFiLDREQUFPQSxDQUFDLFdBQVc7UUFBQ2MsUUFBTztJQUFHLEdBQUdMLE9BQU87SUFDaERNLFNBQVNsQix5REFBSUEsQ0FBQyxZQUFZWSxPQUFPO0lBQ2pDTyxVQUFVYiw0REFBT0EsQ0FBQyxhQUFhTSxPQUFPLEdBQUdRLE9BQU8sQ0FBQztBQUNuRCxHQUFFO0FBRUssTUFBTUMsV0FBV3ZCLDREQUFPQSxDQUFDLFlBQVk7SUFDMUNXLElBQUlWLDJEQUFNQSxDQUFDLE1BQU1XLFVBQVU7SUFDM0JZLFFBQVFsQiw0REFBT0EsQ0FBQyxXQUFXbUIsVUFBVSxDQUFDLElBQU1mLE1BQU1DLEVBQUUsRUFBRUcsT0FBTztJQUM3RFksU0FBU3hCLHlEQUFJQSxDQUFDLFdBQVdZLE9BQU87SUFDaENFLFdBQVdaLDhEQUFTQSxDQUFDLGNBQWNVLE9BQU8sR0FBR0csVUFBVTtJQUN2RFUsTUFBTWxCLGVBQWUsUUFBUUssT0FBTztBQUN0QyxHQUFFO0FBRUssTUFBTWMsZ0JBQWdCNUIsNERBQU9BLENBQUMsaUJBQWlCO0lBQ3BEVyxJQUFJViwyREFBTUEsQ0FBQyxNQUFNVyxVQUFVO0lBQzNCaUIsTUFBTTNCLHlEQUFJQSxDQUFDLFFBQVFZLE9BQU87SUFDMUJnQixPQUFPNUIseURBQUlBLENBQUMsU0FBU1ksT0FBTztJQUM1QmlCLFVBQVU1Qix5REFBSUEsQ0FBQztJQUNmNkIsS0FBSzFCLDREQUFPQSxDQUFDLE9BQU9RLE9BQU87SUFDM0JtQixRQUFRL0IseURBQUlBLENBQUMsVUFBVVksT0FBTztJQUM5Qm9CLE1BQU1oQyx5REFBSUEsQ0FBQyxRQUFRWSxPQUFPO0lBQzFCcUIsV0FBV2pDLHlEQUFJQSxDQUFDLGFBQWFZLE9BQU87SUFDckNzQixRQUFRbEMseURBQUlBLENBQUMsVUFBVVksT0FBTztJQUM5QnVCLFVBQVVuQyx5REFBSUEsQ0FBQyxZQUFZWSxPQUFPO0lBQ2pDRSxXQUFXWiw4REFBU0EsQ0FBQyxjQUFjVSxPQUFPLEdBQUdHLFVBQVU7QUFDekQsR0FBRSIsInNvdXJjZXMiOlsiL1VzZXJzL2Nhcmxvcy9EZXNrdG9wL1RGRy9URkcvc3JjL2xpYi9kYi9zY2hlbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICB7cGdUYWJsZSwgc2VyaWFsLCB0ZXh0LCBkYXRlLCB0aW1lc3RhbXAsIHZhcmNoYXIsIGludGVnZXIsIHBnRW51bSwgYm9vbGVhbn0gZnJvbSAnZHJpenpsZS1vcm0vcGctY29yZSdcblxuZXhwb3J0IGNvbnN0IHVzZXJTeXN0ZW1FbnVtID0gcGdFbnVtKCd1c2VyX3N5c3RlbV9lbnVtJywgWyd1c2VyJywgJ3N5c3RlbScsICdhc3Npc3RhbnQnXSlcblxuZXhwb3J0IGNvbnN0IGNoYXRzID0gcGdUYWJsZSgnY2hhdHMnLCB7XG4gIGlkOiBzZXJpYWwoJ2lkJykucHJpbWFyeUtleSgpLFxuICBwZGZOYW1lOiB0ZXh0KCdwZGZfbmFtZScpLm5vdE51bGwoKSxcbiAgcGRmVXJsOiB0ZXh0KCdwZGZfdXJsJykubm90TnVsbCgpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcpLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXG4gIHVzZXJJZDogdmFyY2hhcigndXNlcl9pZCcsIHtsZW5ndGg6MjU2fSkubm90TnVsbCgpLFxuICBmaWxlS2V5OiB0ZXh0KCdmaWxlX2tleScpLm5vdE51bGwoKSxcbiAgaXNQdWJsaWM6IGJvb2xlYW4oJ2lzX3B1YmxpYycpLm5vdE51bGwoKS5kZWZhdWx0KGZhbHNlKSxcbn0pXG5cbmV4cG9ydCBjb25zdCBtZXNzYWdlcyA9IHBnVGFibGUoJ21lc3NhZ2VzJywge1xuICBpZDogc2VyaWFsKCdpZCcpLnByaW1hcnlLZXkoKSxcbiAgY2hhdElkOiBpbnRlZ2VyKCdjaGF0X2lkJykucmVmZXJlbmNlcygoKSA9PiBjaGF0cy5pZCkubm90TnVsbCgpLFxuICBjb250ZW50OiB0ZXh0KCdjb250ZW50Jykubm90TnVsbCgpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcpLm5vdE51bGwoKS5kZWZhdWx0Tm93KCksXG4gIHJvbGU6IHVzZXJTeXN0ZW1FbnVtKCdyb2xlJykubm90TnVsbCgpLFxufSlcblxuZXhwb3J0IGNvbnN0IHVzZXJfcHJvZmlsZXMgPSBwZ1RhYmxlKCd1c2VyX3Byb2ZpbGVzJywge1xuICBpZDogc2VyaWFsKCdpZCcpLnByaW1hcnlLZXkoKSxcbiAgbmFtZTogdGV4dCgnbmFtZScpLm5vdE51bGwoKSxcbiAgZW1haWw6IHRleHQoJ2VtYWlsJykubm90TnVsbCgpLFxuICBiaXJ0aGRheTogZGF0ZSgnYmlydGhkYXknKSwgXG4gIGFnZTogaW50ZWdlcignYWdlJykubm90TnVsbCgpLFxuICBoZWFsdGg6IHRleHQoJ2hlYWx0aCcpLm5vdE51bGwoKSxcbiAgYmFuazogdGV4dCgnYmFuaycpLm5vdE51bGwoKSxcbiAgcHJvdmluY2lhOiB0ZXh0KCdwcm92aW5jaWEnKS5ub3ROdWxsKCksXG5cdGdlbmVybzogdGV4dCgnZ2VuZXJvJykubm90TnVsbCgpLFxuXHR0ZWxlZm9ubzogdGV4dCgndGVsZWZvbm8nKS5ub3ROdWxsKCksXG4gIGNyZWF0ZWRBdDogdGltZXN0YW1wKCdjcmVhdGVkX2F0Jykubm90TnVsbCgpLmRlZmF1bHROb3coKSxcbn0pXG5cbmV4cG9ydCB0eXBlIEluc2VydENoYXQgPSB0eXBlb2YgY2hhdHMuJGluZmVySW5zZXJ0O1xuZXhwb3J0IHR5cGUgU2VsZWN0Q2hhdCA9IHR5cGVvZiBjaGF0cy4kaW5mZXJTZWxlY3Q7XG5leHBvcnQgdHlwZSBJbnNlcnRNZXNzYWdlID0gdHlwZW9mIG1lc3NhZ2VzLiRpbmZlckluc2VydDtcbmV4cG9ydCB0eXBlIFNlbGVjdE1lc3NhZ2UgPSB0eXBlb2YgbWVzc2FnZXMuJGluZmVyU2VsZWN0O1xuZXhwb3J0IHR5cGUgSW5zZXJ0VXNlclByb2ZpbGUgPSB0eXBlb2YgdXNlcl9wcm9maWxlcy4kaW5mZXJJbnNlcnQ7XG5leHBvcnQgdHlwZSBTZWxlY3RVc2VyUHJvZmlsZSA9IHR5cGVvZiB1c2VyX3Byb2ZpbGVzLiRpbmZlclNlbGVjdDsiXSwibmFtZXMiOlsicGdUYWJsZSIsInNlcmlhbCIsInRleHQiLCJkYXRlIiwidGltZXN0YW1wIiwidmFyY2hhciIsImludGVnZXIiLCJwZ0VudW0iLCJib29sZWFuIiwidXNlclN5c3RlbUVudW0iLCJjaGF0cyIsImlkIiwicHJpbWFyeUtleSIsInBkZk5hbWUiLCJub3ROdWxsIiwicGRmVXJsIiwiY3JlYXRlZEF0IiwiZGVmYXVsdE5vdyIsInVzZXJJZCIsImxlbmd0aCIsImZpbGVLZXkiLCJpc1B1YmxpYyIsImRlZmF1bHQiLCJtZXNzYWdlcyIsImNoYXRJZCIsInJlZmVyZW5jZXMiLCJjb250ZW50Iiwicm9sZSIsInVzZXJfcHJvZmlsZXMiLCJuYW1lIiwiZW1haWwiLCJiaXJ0aGRheSIsImFnZSIsImhlYWx0aCIsImJhbmsiLCJwcm92aW5jaWEiLCJnZW5lcm8iLCJ0ZWxlZm9ubyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db/schema.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/embeddings.ts":
/*!*******************************!*\
  !*** ./src/lib/embeddings.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getEmbeddings: () => (/* binding */ getEmbeddings)\n/* harmony export */ });\n/* harmony import */ var openai_edge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai-edge */ \"(rsc)/./node_modules/.pnpm/openai-edge@1.2.2/node_modules/openai-edge/dist/index.mjs\");\n\nconst config = new openai_edge__WEBPACK_IMPORTED_MODULE_0__.Configuration({\n    apiKey: process.env.OPENAI_API_KEY\n});\nconst openai = new openai_edge__WEBPACK_IMPORTED_MODULE_0__.OpenAIApi(config);\nasync function getEmbeddings(text) {\n    try {\n        const response = await openai.createEmbedding({\n            model: 'text-embedding-3-small',\n            input: text.replace(/\\n/g, ' ')\n        });\n        const result = await response.json();\n        return result.data[0].embedding;\n    } catch (error) {\n        console.log('Error en la llamada a OpenAI embeddings API', error);\n        throw error;\n    }\n} //*REVISADO*//\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2VtYmVkZGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBb0Q7QUFFcEQsTUFBTUUsU0FBUyxJQUFJRCxzREFBYUEsQ0FBQztJQUMvQkUsUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxjQUFjO0FBQ3BDO0FBRUEsTUFBTUMsU0FBUyxJQUFJUCxrREFBU0EsQ0FBQ0U7QUFFdEIsZUFBZU0sY0FBY0MsSUFBWTtJQUM5QyxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxNQUFNSCxPQUFPSSxlQUFlLENBQUM7WUFDNUNDLE9BQU87WUFDUEMsT0FBT0osS0FBS0ssT0FBTyxDQUFDLE9BQU87UUFDN0I7UUFFQSxNQUFNQyxTQUFTLE1BQU1MLFNBQVNNLElBQUk7UUFDbEMsT0FBT0QsT0FBT0UsSUFBSSxDQUFDLEVBQUUsQ0FBQ0MsU0FBUztJQUVqQyxFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUMsR0FBRyxDQUFDLCtDQUErQ0Y7UUFDM0QsTUFBTUE7SUFDUjtBQUNGLEVBRUEsY0FBYyIsInNvdXJjZXMiOlsiL1VzZXJzL2Nhcmxvcy9EZXNrdG9wL1RGRy9URkcvc3JjL2xpYi9lbWJlZGRpbmdzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7T3BlbkFJQXBpLCBDb25maWd1cmF0aW9ufSBmcm9tICdvcGVuYWktZWRnZSdcblxuY29uc3QgY29uZmlnID0gbmV3IENvbmZpZ3VyYXRpb24oe1xuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZXG59KVxuXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJQXBpKGNvbmZpZylcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEVtYmVkZGluZ3ModGV4dDogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuY3JlYXRlRW1iZWRkaW5nKHtcbiAgICAgIG1vZGVsOiAndGV4dC1lbWJlZGRpbmctMy1zbWFsbCcsXG4gICAgICBpbnB1dDogdGV4dC5yZXBsYWNlKC9cXG4vZywgJyAnKVxuICAgIH0pXG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICByZXR1cm4gcmVzdWx0LmRhdGFbMF0uZW1iZWRkaW5nIGFzIG51bWJlcltdXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZygnRXJyb3IgZW4gbGEgbGxhbWFkYSBhIE9wZW5BSSBlbWJlZGRpbmdzIEFQSScsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuLy8qUkVWSVNBRE8qLy8iXSwibmFtZXMiOlsiT3BlbkFJQXBpIiwiQ29uZmlndXJhdGlvbiIsImNvbmZpZyIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsIm9wZW5haSIsImdldEVtYmVkZGluZ3MiLCJ0ZXh0IiwicmVzcG9uc2UiLCJjcmVhdGVFbWJlZGRpbmciLCJtb2RlbCIsImlucHV0IiwicmVwbGFjZSIsInJlc3VsdCIsImpzb24iLCJkYXRhIiwiZW1iZWRkaW5nIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/embeddings.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils.ts":
/*!**************************!*\
  !*** ./src/lib/utils.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cn: () => (/* binding */ cn),\n/* harmony export */   convertToAscii: () => (/* binding */ convertToAscii)\n/* harmony export */ });\n/* harmony import */ var clsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! clsx */ \"(rsc)/./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs\");\n/* harmony import */ var tailwind_merge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tailwind-merge */ \"(rsc)/./node_modules/.pnpm/tailwind-merge@2.5.4/node_modules/tailwind-merge/dist/bundle-mjs.mjs\");\n\n\nfunction cn(...inputs) {\n    return (0,tailwind_merge__WEBPACK_IMPORTED_MODULE_1__.twMerge)((0,clsx__WEBPACK_IMPORTED_MODULE_0__.clsx)(inputs));\n}\nfunction convertToAscii(inputString) {\n    //Eliminar los caracteres especiales\n    const assciiString = inputString.replace(/[^\\x00- \\x7F]+/g, \"\");\n    return assciiString;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3V0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEM7QUFDSjtBQUVqQyxTQUFTRSxHQUFHLEdBQUdDLE1BQW9CO0lBQ3hDLE9BQU9GLHVEQUFPQSxDQUFDRCwwQ0FBSUEsQ0FBQ0c7QUFDdEI7QUFHTyxTQUFTQyxlQUFlQyxXQUFtQjtJQUNoRCxvQ0FBb0M7SUFDcEMsTUFBTUMsZUFBZUQsWUFBWUUsT0FBTyxDQUFDLG1CQUFtQjtJQUM1RCxPQUFPRDtBQUNUIiwic291cmNlcyI6WyIvVXNlcnMvY2FybG9zL0Rlc2t0b3AvVEZHL1RGRy9zcmMvbGliL3V0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNsc3gsIHR5cGUgQ2xhc3NWYWx1ZSB9IGZyb20gXCJjbHN4XCJcbmltcG9ydCB7IHR3TWVyZ2UgfSBmcm9tIFwidGFpbHdpbmQtbWVyZ2VcIlxuXG5leHBvcnQgZnVuY3Rpb24gY24oLi4uaW5wdXRzOiBDbGFzc1ZhbHVlW10pIHtcbiAgcmV0dXJuIHR3TWVyZ2UoY2xzeChpbnB1dHMpKVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VG9Bc2NpaShpbnB1dFN0cmluZzogc3RyaW5nKSB7XG4gIC8vRWxpbWluYXIgbG9zIGNhcmFjdGVyZXMgZXNwZWNpYWxlc1xuICBjb25zdCBhc3NjaWlTdHJpbmcgPSBpbnB1dFN0cmluZy5yZXBsYWNlKC9bXlxceDAwLSBcXHg3Rl0rL2csIFwiXCIpXG4gIHJldHVybiBhc3NjaWlTdHJpbmdcbn1cblxuIl0sIm5hbWVzIjpbImNsc3giLCJ0d01lcmdlIiwiY24iLCJpbnB1dHMiLCJjb252ZXJ0VG9Bc2NpaSIsImlucHV0U3RyaW5nIiwiYXNzY2lpU3RyaW5nIiwicmVwbGFjZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/queries.ts":
/*!**********************************!*\
  !*** ./src/lib/utils/queries.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAccessibleChats: () => (/* binding */ getAccessibleChats),\n/* harmony export */   saveChat: () => (/* binding */ saveChat)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db/index.ts\");\n/* harmony import */ var _lib_db_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db/schema */ \"(rsc)/./src/lib/db/schema.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n\n\n\nasync function saveChat({ id, messages }) {\n    try {\n        for (const message of messages){\n            await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db.insert(_lib_db_schema__WEBPACK_IMPORTED_MODULE_1__.messages).values({\n                chatId: id,\n                content: message.content,\n                role: message.role,\n                createdAt: new Date()\n            });\n        }\n    } catch (error) {\n        console.error('Error al guardar el chat en la base de datos:', error);\n        throw error;\n    }\n}\n// Function to get accessible chats\nasync function getAccessibleChats(userId) {\n    return await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db.select().from(_lib_db_schema__WEBPACK_IMPORTED_MODULE_1__.chats).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.or)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_1__.chats.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_1__.chats.isPublic, true)));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3V0aWxzL3F1ZXJpZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBOEI7QUFDcUM7QUFDOUI7QUFPOUIsZUFBZU0sU0FBUyxFQUM3QkMsRUFBRSxFQUNGTCxRQUFRLEVBTVQ7SUFDQyxJQUFJO1FBQ0YsS0FBSyxNQUFNTSxXQUFXTixTQUFVO1lBQzlCLE1BQU1GLHVDQUFFQSxDQUFDUyxNQUFNLENBQUNOLG9EQUFhQSxFQUFFTyxNQUFNLENBQUM7Z0JBQ3BDQyxRQUFRSjtnQkFDUkssU0FBU0osUUFBUUksT0FBTztnQkFDeEJDLE1BQU1MLFFBQVFLLElBQUk7Z0JBQ2xCQyxXQUFXLElBQUlDO1lBQ2pCO1FBQ0Y7SUFDRixFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlEQUFpREE7UUFDL0QsTUFBTUE7SUFDUjtBQUNGO0FBRUEsbUNBQW1DO0FBQzVCLGVBQWVFLG1CQUFtQkMsTUFBYztJQUNyRCxPQUFPLE1BQU1uQix1Q0FBRUEsQ0FDWm9CLE1BQU0sR0FDTkMsSUFBSSxDQUFDcEIsaURBQUtBLEVBQ1ZxQixLQUFLLENBQ0pqQiwrQ0FBRUEsQ0FDQUQsK0NBQUVBLENBQUNILGlEQUFLQSxDQUFDa0IsTUFBTSxFQUFFQSxTQUNqQmYsK0NBQUVBLENBQUNILGlEQUFLQSxDQUFDc0IsUUFBUSxFQUFFO0FBRzNCIiwic291cmNlcyI6WyIvVXNlcnMvY2FybG9zL0Rlc2t0b3AvVEZHL1RGRy9zcmMvbGliL3V0aWxzL3F1ZXJpZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIgfSBmcm9tICdAL2xpYi9kYic7XG5pbXBvcnQgeyBjaGF0cywgbWVzc2FnZXMgYXMgbWVzc2FnZXNUYWJsZSB9IGZyb20gJ0AvbGliL2RiL3NjaGVtYSc7XG5pbXBvcnQgeyBlcSwgb3IgfSBmcm9tICdkcml6emxlLW9ybSc7XG5cbmludGVyZmFjZSBDaGF0TWVzc2FnZSB7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcm9sZTogJ3VzZXInIHwgJ3N5c3RlbScgfCAnYXNzaXN0YW50Jztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVDaGF0KHtcbiAgaWQsXG4gIG1lc3NhZ2VzLFxuICAvL3VzZXJJZCxcbn06IHtcbiAgaWQ6IG51bWJlcjtcbiAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XG4gIHVzZXJJZDogc3RyaW5nO1xufSkge1xuICB0cnkge1xuICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuICAgICAgYXdhaXQgZGIuaW5zZXJ0KG1lc3NhZ2VzVGFibGUpLnZhbHVlcyh7XG4gICAgICAgIGNoYXRJZDogaWQsXG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UuY29udGVudCxcbiAgICAgICAgcm9sZTogbWVzc2FnZS5yb2xlLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgYWwgZ3VhcmRhciBlbCBjaGF0IGVuIGxhIGJhc2UgZGUgZGF0b3M6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8vIEZ1bmN0aW9uIHRvIGdldCBhY2Nlc3NpYmxlIGNoYXRzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjZXNzaWJsZUNoYXRzKHVzZXJJZDogc3RyaW5nKSB7XG4gIHJldHVybiBhd2FpdCBkYlxuICAgIC5zZWxlY3QoKVxuICAgIC5mcm9tKGNoYXRzKVxuICAgIC53aGVyZShcbiAgICAgIG9yKFxuICAgICAgICBlcShjaGF0cy51c2VySWQsIHVzZXJJZCksXG4gICAgICAgIGVxKGNoYXRzLmlzUHVibGljLCB0cnVlKVxuICAgICAgKVxuICAgICk7XG59Il0sIm5hbWVzIjpbImRiIiwiY2hhdHMiLCJtZXNzYWdlcyIsIm1lc3NhZ2VzVGFibGUiLCJlcSIsIm9yIiwic2F2ZUNoYXQiLCJpZCIsIm1lc3NhZ2UiLCJpbnNlcnQiLCJ2YWx1ZXMiLCJjaGF0SWQiLCJjb250ZW50Iiwicm9sZSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRBY2Nlc3NpYmxlQ2hhdHMiLCJ1c2VySWQiLCJzZWxlY3QiLCJmcm9tIiwid2hlcmUiLCJpc1B1YmxpYyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/queries.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/@opentelemetry+api@1.9.0","vendor-chunks/@clerk+shared@2.12.1_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/@clerk+backend@1.16.2_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/@clerk+nextjs@6.3.2_next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react_erh4rexutio6xfxki4qahuk4f4","vendor-chunks/crypto-js@4.2.0","vendor-chunks/tslib@2.8.1","vendor-chunks/cookie@0.7.0","vendor-chunks/map-obj@4.3.0","vendor-chunks/no-case@3.0.4","vendor-chunks/lower-case@2.0.2","vendor-chunks/snakecase-keys@5.4.4","vendor-chunks/snake-case@3.0.4","vendor-chunks/dot-case@3.0.4","vendor-chunks/clsx@2.1.1","vendor-chunks/drizzle-orm@0.36.1_@libsql+client@0.14.0_@neondatabase+serverless@0.10.4_@opentelemetry+api@1_jneduajdzsu5gejq55b43hmr3e","vendor-chunks/@neondatabase+serverless@0.10.4","vendor-chunks/zod@3.23.8","vendor-chunks/ai@3.4.33_openai@4.72.0_encoding@0.1.13_zod@3.23.8__react@18.3.1_sswr@2.1.0_svelte@5.2.2__sve_qsxmzikk3s2dtpwsa2wxtn3lvi","vendor-chunks/tailwind-merge@2.5.4","vendor-chunks/zod-to-json-schema@3.23.5_zod@3.23.8","vendor-chunks/@ai-sdk+ui-utils@0.0.50_zod@3.23.8","vendor-chunks/@ai-sdk+provider@0.0.26","vendor-chunks/@ai-sdk+provider-utils@1.0.22_zod@3.23.8","vendor-chunks/eventsource-parser@1.1.2","vendor-chunks/secure-json-parse@2.7.0","vendor-chunks/nanoid@3.3.7","vendor-chunks/@pinecone-database+pinecone@4.0.0","vendor-chunks/eventsource-parser@3.0.0","vendor-chunks/openai-edge@1.2.2","vendor-chunks/nanoid@5.0.8","vendor-chunks/@ai-sdk+provider@1.0.0","vendor-chunks/@ai-sdk+provider-utils@2.0.0_zod@3.23.8","vendor-chunks/@ai-sdk+openai@1.0.1_zod@3.23.8"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.0.3_@opentelemetry+api@1.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.tsx&appDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarlos%2FDesktop%2FTFG%2FTFG&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();